{
  "$schema": "https://railway.json.schema",
  "services": {
    "backend": {
      "dockerfile": "./backend-rust/Dockerfile",
      "buildCommand": "",
      "startCommand": "/app/server",
      "variables": {
        "SERVER_HOST": "0.0.0.0",
        "SERVER_PORT": "$PORT",
        "ADMIN_CODE": "122601",
        "RUST_LOG": "info",
        "DATABASE_URL": "${{ services.postgres.variables.DATABASE_URL }}"
      }
    },
    "frontend": {
      "buildCommand": "npm install && npm run build",
      "startCommand": "npm run preview",
      "variables": {
        "VITE_API_URL": "${{ services.backend.public.url }}"
      }
    },
    "postgres": {
      "image": "postgres:15-alpine",
      "variables": {
        "POSTGRES_USER": "postgres",
        "POSTGRES_PASSWORD": "${{ secrets.DB_PASSWORD }}",
        "POSTGRES_DB": "guard_firearm_system"
      }
    }
  }
}
